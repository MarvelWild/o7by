(function(b){if(typeof define==="function"&&define.amd){define(["./blueimp-helper","./blueimp-gallery-video"],b)}else{b(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}})(function(i,h){if(!window.postMessage){return h}var j=h.prototype;i.extend(j.options,{youTubeVideoIdProperty:"youtube",youTubePlayerVars:{wmode:"transparent"},youTubeClickToPlay:false});var f=j.textFactory||j.imageFactory;var g=function(b,a,c){this.videoId=b;this.playerVars=a;this.clickToPlay=c;this.element=document.createElement("div");this.listeners={}};i.extend(g.prototype,{on:function(b,a){this.listeners[b]=a;return this},loadAPI:function(){var c=this;var m=window.onYouTubeIframeAPIReady;var a="https://www.youtube.com/iframe_api";var b=document.getElementsByTagName("script");var e=b.length;var d;window.onYouTubeIframeAPIReady=function(){if(m){m.apply(this)}if(c.playOnReady){c.play()}};while(e){e-=1;if(b[e].src===a){return}}d=document.createElement("script");d.src=a;b[0].parentNode.insertBefore(d,b[0])},onReady:function(){this.ready=true;if(this.playOnReady){this.play()}},onPlaying:function(){if(this.playStatus<2){this.listeners.playing();this.playStatus=2}},onPause:function(){this.listeners.pause();delete this.playStatus},onStateChange:function(a){window.clearTimeout(this.pauseTimeout);switch(a.data){case YT.PlayerState.PLAYING:this.hasPlayed=true;this.onPlaying();break;case YT.PlayerState.UNSTARTED:case YT.PlayerState.PAUSED:this.pauseTimeout=j.setTimeout.call(this,this.onPause,null,500);break;case YT.PlayerState.ENDED:this.onPause();break}},onError:function(a){this.listeners.error(a)},play:function(){var a=this;if(!this.playStatus){this.listeners.play();this.playStatus=1}if(this.ready){if(!this.hasPlayed&&(this.clickToPlay||(window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform)))){this.onPlaying()}else{this.player.playVideo()}}else{this.playOnReady=true;if(!(window.YT&&YT.Player)){this.loadAPI()}else{if(!this.player){this.player=new YT.Player(this.element,{videoId:this.videoId,playerVars:this.playerVars,events:{onReady:function(){a.onReady()},onStateChange:function(b){a.onStateChange(b)},onError:function(b){a.onError(b)}}})}}}},pause:function(){if(this.ready){this.player.pauseVideo()}else{if(this.playStatus){delete this.playOnReady;this.listeners.pause();delete this.playStatus}}}});i.extend(j,{YouTubePlayer:g,textFactory:function(b,a){var d=this.options;var c=this.getItemProperty(b,d.youTubeVideoIdProperty);if(c){if(this.getItemProperty(b,d.urlProperty)===undefined){b[d.urlProperty]="https://www.youtube.com/watch?v="+c}if(this.getItemProperty(b,d.videoPosterProperty)===undefined){b[d.videoPosterProperty]="https://img.youtube.com/vi/"+c+"/maxresdefault.jpg"}return this.videoFactory(b,a,new g(c,d.youTubePlayerVars,d.youTubeClickToPlay))}return f.call(this,b,a)}});return h});