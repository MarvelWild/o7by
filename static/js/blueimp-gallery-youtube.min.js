(function(a){if(typeof define==="function"&&define.amd){define(["./blueimp-helper","./blueimp-gallery-video"],a)}else{a(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}})(function(d,e){if(!window.postMessage){return e}var c=e.prototype;d.extend(c.options,{youTubeVideoIdProperty:"youtube",youTubePlayerVars:{wmode:"transparent"},youTubeClickToPlay:false});var b=c.textFactory||c.imageFactory;var a=function(g,h,f){this.videoId=g;this.playerVars=h;this.clickToPlay=f;this.element=document.createElement("div");this.listeners={}};d.extend(a.prototype,{on:function(f,g){this.listeners[f]=g;return this},loadAPI:function(){var j=this;var f=window.onYouTubeIframeAPIReady;var l="https://www.youtube.com/iframe_api";var k=document.getElementsByTagName("script");var g=k.length;var h;window.onYouTubeIframeAPIReady=function(){if(f){f.apply(this)}if(j.playOnReady){j.play()}};while(g){g-=1;if(k[g].src===l){return}}h=document.createElement("script");h.src=l;k[0].parentNode.insertBefore(h,k[0])},onReady:function(){this.ready=true;if(this.playOnReady){this.play()}},onPlaying:function(){if(this.playStatus<2){this.listeners.playing();this.playStatus=2}},onPause:function(){this.listeners.pause();delete this.playStatus},onStateChange:function(f){window.clearTimeout(this.pauseTimeout);switch(f.data){case YT.PlayerState.PLAYING:this.hasPlayed=true;this.onPlaying();break;case YT.PlayerState.UNSTARTED:case YT.PlayerState.PAUSED:this.pauseTimeout=c.setTimeout.call(this,this.onPause,null,500);break;case YT.PlayerState.ENDED:this.onPause();break}},onError:function(f){this.listeners.error(f)},play:function(){var f=this;if(!this.playStatus){this.listeners.play();this.playStatus=1}if(this.ready){if(!this.hasPlayed&&(this.clickToPlay||(window.navigator&&/iP(hone|od|ad)/.test(window.navigator.platform)))){this.onPlaying()}else{this.player.playVideo()}}else{this.playOnReady=true;if(!(window.YT&&YT.Player)){this.loadAPI()}else{if(!this.player){this.player=new YT.Player(this.element,{videoId:this.videoId,playerVars:this.playerVars,events:{onReady:function(){f.onReady()},onStateChange:function(g){f.onStateChange(g)},onError:function(g){f.onError(g)}}})}}}},pause:function(){if(this.ready){this.player.pauseVideo()}else{if(this.playStatus){delete this.playOnReady;this.listeners.pause();delete this.playStatus}}}});d.extend(c,{YouTubePlayer:a,textFactory:function(h,i){var f=this.options;var g=this.getItemProperty(h,f.youTubeVideoIdProperty);if(g){if(this.getItemProperty(h,f.urlProperty)===undefined){h[f.urlProperty]="https://www.youtube.com/watch?v="+g}if(this.getItemProperty(h,f.videoPosterProperty)===undefined){h[f.videoPosterProperty]="https://img.youtube.com/vi/"+g+"/maxresdefault.jpg"}return this.videoFactory(h,i,new a(g,f.youTubePlayerVars,f.youTubeClickToPlay))}return b.call(this,h,i)}});return e});